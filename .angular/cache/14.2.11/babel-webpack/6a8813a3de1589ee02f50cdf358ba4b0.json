{"ast":null,"code":"import emailjs from 'emailjs-com';\nimport { ActivatedRoute } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../shared/image.service\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\n\nfunction CartComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 29)(1, \"div\", 3);\n    i0.ɵɵelement(2, \"img\", 30);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 4)(4, \"div\", 31);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 32);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"div\", 5);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 33)(11, \"input\", 34);\n    i0.ɵɵlistener(\"ngModelChange\", function CartComponent_div_14_Template_input_ngModelChange_11_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const item_r1 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(item_r1.quantity = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"div\", 7)(13, \"button\", 35);\n    i0.ɵɵlistener(\"click\", function CartComponent_div_14_Template_button_click_13_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const item_r1 = restoredCtx.$implicit;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.removeFromCart(item_r1.id));\n    });\n    i0.ɵɵtext(14, \" Remove \");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const item_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", item_r1.imageUrl, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r1.productName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r1.productDescription);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r1.productPrice);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", item_r1.quantity);\n  }\n}\n\nexport let CartComponent = /*#__PURE__*/(() => {\n  class CartComponent {\n    constructor(cartService, http, route) {\n      this.cartService = cartService;\n      this.http = http;\n      this.route = route;\n      this.cartItems = [];\n      this.btnValue = 'Send Email';\n      this.cartItems.forEach(item => {\n        item.quantity = 1;\n      });\n    }\n\n    ngOnInit() {\n      this.route.queryParams.subscribe(params => {\n        this.currentUserEmail = params['email'];\n        this.actualEmail = params['actualEmail'];\n        console.log(this.currentUserEmail + \"currentuseremail\");\n      });\n      this.fetchCartItems(this.currentUserEmail);\n    }\n\n    fetchCartItems(currentUserEmail) {\n      this.cartService.getCartItems(currentUserEmail).subscribe(items => {\n        this.cartItems = items;\n        console.log(items);\n      });\n    }\n\n    removeFromCart(item) {\n      this.cartService.deleteFromCart(item, this.currentUserEmail).then(() => {\n        // Item removed from cart successfully\n        console.log(\"working\");\n      }).catch(error => {\n        console.log('Error removing item from cart:', error);\n      });\n    }\n\n    calculateLineTotal(item) {\n      return item.price * item.quantity;\n    }\n\n    calculateSubtotal() {\n      let subtotal = 0;\n\n      for (const item of this.cartItems) {\n        subtotal += this.calculateLineTotal(item);\n      }\n\n      return subtotal;\n    }\n\n    calculateTax() {\n      return this.calculateSubtotal() * 0.05; // Assuming 5% tax rate\n    }\n\n    calculateShipping() {\n      return 15.00; // Replace with your actual shipping cost calculation\n    }\n\n    calculateGrandTotal() {\n      return this.calculateSubtotal() + this.calculateTax() + this.calculateShipping();\n    }\n\n    sendEmails() {\n      this.btnValue = 'Sending...';\n      const serviceID = 'default_service';\n      const templateID = 'template_by7nelr';\n      const userID = '02q_sPSjlR7D5mYBQ'; // Replace with your actual User ID\n\n      emailjs.send(serviceID, templateID, {\n        from_name: 'your valuable customer',\n        to_name: 'Annapurna Wholesale',\n        email_id: this.actualEmail,\n        phone_number: \"17811482\",\n        address: \"Thimphu Bhutan\",\n        message: this.generateEmailMessage(),\n        reply_to: this.actualEmail\n      }, userID).then(() => {\n        this.btnValue = 'Send Email';\n        alert('Sent!');\n      }, err => {\n        this.btnValue = 'Send Email';\n        alert(JSON.stringify(err));\n      });\n    }\n\n    generateEmailMessage() {\n      let message = '';\n      this.cartItems.forEach(item => {\n        message += `Product Name: ${item.productName}\\n`;\n        message += `Product Description: ${item.productDescription}\\n`;\n        message += `Product Price: ${item.productPrice}\\n`;\n        message += `Product Quantity: ${item.quantity}\\n\\n`;\n      });\n      console.log(message);\n      return message;\n    }\n\n  }\n\n  CartComponent.ɵfac = function CartComponent_Factory(t) {\n    return new (t || CartComponent)(i0.ɵɵdirectiveInject(i1.ImageService), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i3.ActivatedRoute));\n  };\n\n  CartComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CartComponent,\n    selectors: [[\"app-cart\"]],\n    decls: 77,\n    vars: 1,\n    consts: [[1, \"container\"], [1, \"shopping-cart\", \"container\"], [1, \"column-labels\"], [1, \"product-image\"], [1, \"product-details\"], [1, \"product-price\"], [1, \"product-quantity\"], [1, \"product-removal\"], [\"class\", \"product\", 4, \"ngFor\", \"ngForOf\"], [1, \"row\"], [1, \"col-sm-8\", \"col-sm-offset-2\"], [\"action\", \"\", 1, \"pad-bg\"], [1, \"text-center\"], [1, \"form-group\"], [\"for\", \"\"], [\"type\", \"text\", 1, \"i-box\", \"form-control\", \"input-lg\"], [\"type\", \"text\", 1, \"form-control\", \"input-lg\"], [1, \"checkbox\"], [\"type\", \"checkbox\"], [1, \"btn\", \"btn-default\", \"btn-lg\"], [\"action\", \"\", 1, \"form-horizontal\", \"pad-bg\"], [\"for\", \"\", 1, \"control-label\", \"col-sm-3\"], [1, \"col-sm-9\"], [1, \"col-sm-offset-3\", \"col-sm-9\"], [\"action\", \"\", 1, \"form-inline\", \"pad-bg\"], [\"for\", \"\", 1, \"sr-only\"], [\"type\", \"text\", \"placeholder\", \"Email\", 1, \"form-control\", \"input-lg\"], [\"type\", \"text\", \"placeholder\", \"Password\", 1, \"form-control\", \"input-lg\"], [\"type\", \"submit\", \"id\", \"button\", 1, \"checkout\", 3, \"click\"], [1, \"product\"], [\"alt\", \"Product Image\", 3, \"src\"], [1, \"product-title\"], [1, \"product-description\"], [1, \"product-quantity\", 2, \"border\", \"1px solid black\", \"padding\", \"0px\", \"margin-right\", \"16px\"], [\"placeholder\", \"\", \"type\", \"number\", \"min\", \"1\", \"name\", \"productQuantity\", 2, \"width\", \"67px\", 3, \"ngModel\", \"ngModelChange\"], [1, \"remove-product\", 3, \"click\"]],\n    template: function CartComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h1\", 0);\n        i0.ɵɵtext(1, \"Shopping Cart\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"div\", 1)(3, \"div\", 2)(4, \"label\", 3);\n        i0.ɵɵtext(5, \"Image\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"label\", 4);\n        i0.ɵɵtext(7, \"Product\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"label\", 5);\n        i0.ɵɵtext(9, \"Price\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"label\", 6);\n        i0.ɵɵtext(11, \"Quantity\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"label\", 7);\n        i0.ɵɵtext(13, \"Remove\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(14, CartComponent_div_14_Template, 15, 5, \"div\", 8);\n        i0.ɵɵelementStart(15, \"div\", 0)(16, \"div\", 9)(17, \"div\", 10)(18, \"form\", 11)(19, \"h1\", 12);\n        i0.ɵɵtext(20, \"Default form\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"div\", 13)(22, \"label\", 14);\n        i0.ɵɵtext(23, \"Email\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(24, \"input\", 15);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"div\", 13)(26, \"label\", 14);\n        i0.ɵɵtext(27, \"Password\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(28, \"input\", 16);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"div\", 17)(30, \"label\", 14);\n        i0.ɵɵelement(31, \"input\", 18);\n        i0.ɵɵtext(32, \" Remember me \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(33, \"button\", 19);\n        i0.ɵɵtext(34, \"Signin\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(35, \"form\", 20)(36, \"h1\", 12);\n        i0.ɵɵtext(37, \"Horizontal form\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"div\", 13)(39, \"label\", 21);\n        i0.ɵɵtext(40, \"Email\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(41, \"div\", 22);\n        i0.ɵɵelement(42, \"input\", 16);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(43, \"div\", 13)(44, \"label\", 21);\n        i0.ɵɵtext(45, \"Password\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(46, \"div\", 22);\n        i0.ɵɵelement(47, \"input\", 16);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(48, \"div\", 13)(49, \"div\", 23)(50, \"div\", 17)(51, \"label\", 14);\n        i0.ɵɵelement(52, \"input\", 18);\n        i0.ɵɵtext(53, \" Remember me \");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(54, \"div\", 13)(55, \"div\", 23)(56, \"button\", 19);\n        i0.ɵɵtext(57, \"Sign in\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(58, \"form\", 24)(59, \"h1\", 12);\n        i0.ɵɵtext(60, \"Inline form\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(61, \"div\", 13)(62, \"label\", 25);\n        i0.ɵɵtext(63, \"Email\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(64, \"input\", 26);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(65, \"div\", 13)(66, \"label\", 25);\n        i0.ɵɵtext(67, \"Password\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(68, \"input\", 27);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(69, \"div\", 17)(70, \"label\", 14);\n        i0.ɵɵelement(71, \"input\", 18);\n        i0.ɵɵtext(72, \" Remember me \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(73, \"button\", 19);\n        i0.ɵɵtext(74, \"Signin\");\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(75, \"button\", 28);\n        i0.ɵɵlistener(\"click\", function CartComponent_Template_button_click_75_listener() {\n          return ctx.sendEmails();\n        });\n        i0.ɵɵtext(76, \"Checkout\");\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(14);\n        i0.ɵɵproperty(\"ngForOf\", ctx.cartItems);\n      }\n    },\n    dependencies: [i4.NgForOf, i5.ɵNgNoValidate, i5.DefaultValueAccessor, i5.NumberValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.MinValidator, i5.NgModel, i5.NgForm],\n    styles: [\".shopping-cart[_ngcontent-%COMP%]{margin-top:-45px}@media screen and (max-width: 650px){.shopping-cart[_ngcontent-%COMP%]{margin:0;padding-top:20px;border-top:1px solid #eee}.column-labels[_ngcontent-%COMP%]{display:none}.product-image[_ngcontent-%COMP%]{float:right;width:auto}.product-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0 0 10px 10px}.product-details[_ngcontent-%COMP%]{float:none;margin-bottom:10px;width:auto}.product-price[_ngcontent-%COMP%]{clear:both;width:70px}.product-quantity[_ngcontent-%COMP%]{width:100px}.product-quantity[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:20px}.product-quantity[_ngcontent-%COMP%]:before{content:\\\"x\\\"}.product-removal[_ngcontent-%COMP%]{width:auto}.product-line-price[_ngcontent-%COMP%]{float:right;width:70px}}@media screen and (max-width: 350px){.product-removal[_ngcontent-%COMP%]{float:right}.product-line-price[_ngcontent-%COMP%]{float:right;clear:left;width:-moz-max-content;width:max-content;margin-top:10px}.product[_ngcontent-%COMP%]   .product-line-price[_ngcontent-%COMP%]:before{content:\\\"Item Total: $\\\"}.totals[_ngcontent-%COMP%]   .totals-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:60%}.totals[_ngcontent-%COMP%]   .totals-item[_ngcontent-%COMP%]   .totals-value[_ngcontent-%COMP%]{width:40%}}.product-image[_ngcontent-%COMP%]{float:left;width:20%}.product-details[_ngcontent-%COMP%]{float:left;width:37%}.product-price[_ngcontent-%COMP%]{float:left;width:12%}.product-quantity[_ngcontent-%COMP%]{float:left;width:10%}.product-removal[_ngcontent-%COMP%]{float:left;width:9%}.product-line-price[_ngcontent-%COMP%]{float:left;width:12%;text-align:right}.group[_ngcontent-%COMP%]:before, .shopping-cart[_ngcontent-%COMP%]:before, .column-labels[_ngcontent-%COMP%]:before, .product[_ngcontent-%COMP%]:before, .totals-item[_ngcontent-%COMP%]:before, .group[_ngcontent-%COMP%]:after, .shopping-cart[_ngcontent-%COMP%]:after, .column-labels[_ngcontent-%COMP%]:after, .product[_ngcontent-%COMP%]:after, .totals-item[_ngcontent-%COMP%]:after{content:\\\"\\\";display:table}.group[_ngcontent-%COMP%]:after, .shopping-cart[_ngcontent-%COMP%]:after, .column-labels[_ngcontent-%COMP%]:after, .product[_ngcontent-%COMP%]:after, .totals-item[_ngcontent-%COMP%]:after{clear:both}.group[_ngcontent-%COMP%], .shopping-cart[_ngcontent-%COMP%], .column-labels[_ngcontent-%COMP%], .product[_ngcontent-%COMP%], .totals-item[_ngcontent-%COMP%]{zoom:1}body[_ngcontent-%COMP%]{padding:0 30px 30px 20px;font-family:HelveticaNeue-Light,Helvetica Neue Light,Helvetica Neue,Helvetica,Arial,sans-serif;font-weight:100}h1[_ngcontent-%COMP%]{font-weight:100}label[_ngcontent-%COMP%]{color:#aaa}.shopping-cart[_ngcontent-%COMP%]{margin-top:3px}.column-labels[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding-bottom:15px;margin-bottom:15px;border-bottom:1px solid #eee}.column-labels[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%], .column-labels[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%], .column-labels[_ngcontent-%COMP%]   .product-removal[_ngcontent-%COMP%]{text-indent:-9999px}.product[_ngcontent-%COMP%]{margin-bottom:20px;padding-bottom:10px;border-bottom:1px solid #eee}.product[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]{text-align:center}.product[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px}.product[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-title[_ngcontent-%COMP%]{margin-right:20px;font-family:HelveticaNeue-Medium,Helvetica Neue Medium}.product[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-description[_ngcontent-%COMP%]{margin:5px 20px 5px 0;line-height:1.4em}.product[_ngcontent-%COMP%]   .product-quantity[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:40px}.product[_ngcontent-%COMP%]   .remove-product[_ngcontent-%COMP%]{border:0;padding:4px 8px;background-color:#c66;color:#fff;font-family:HelveticaNeue-Medium,Helvetica Neue Medium;font-size:12px;border-radius:3px}.product[_ngcontent-%COMP%]   .remove-product[_ngcontent-%COMP%]:hover{background-color:#a44}.totals[_ngcontent-%COMP%]   .totals-item[_ngcontent-%COMP%]{float:right;clear:both;width:100%;margin-bottom:10px}.totals[_ngcontent-%COMP%]   .totals-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{float:left;clear:both;width:79%}.totals[_ngcontent-%COMP%]   .totals-item[_ngcontent-%COMP%]   .totals-value[_ngcontent-%COMP%]{float:right;width:21%}.totals[_ngcontent-%COMP%]   .totals-item-total[_ngcontent-%COMP%]{font-family:HelveticaNeue-Medium,Helvetica Neue Medium}.checkout[_ngcontent-%COMP%]{float:right;border:0;margin-top:20px;padding:6px 25px;background-color:#6b6;color:#fff;font-size:25px;border-radius:3px}.checkout[_ngcontent-%COMP%]:hover{background-color:#494}@media screen and (max-width: 480px){.product-image[_ngcontent-%COMP%]{float:none;width:auto}.product-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:0}.product-details[_ngcontent-%COMP%]{float:none;width:auto;margin-bottom:10px}.product-price[_ngcontent-%COMP%]{float:none;clear:both;width:auto}.product-quantity[_ngcontent-%COMP%]{float:none;width:auto}.product-quantity[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:0;width:40px}.product-quantity[_ngcontent-%COMP%]:before{content:\\\"x\\\"}.product-removal[_ngcontent-%COMP%]{float:none;width:auto}.product-line-price[_ngcontent-%COMP%]{float:none;clear:left;width:-moz-max-content;width:max-content;margin-top:10px}.product[_ngcontent-%COMP%]   .product-line-price[_ngcontent-%COMP%]:before{content:\\\"Item Total: $\\\"}.totals[_ngcontent-%COMP%]   .totals-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:26%}.totals[_ngcontent-%COMP%]   .totals-item[_ngcontent-%COMP%]   .totals-value[_ngcontent-%COMP%]{width:40%}}\"]\n  });\n  return CartComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}